<html><head><base href="https://Mokie.com">
<title>Mokie The Internet Scroller</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
    :root {
        --primary-color: #e94560;
        --background-color: #0a0a0a;
        --text-color: #ffffff;
        --secondary-color: #1a1a1a;
        --border-color: #000000;
    }

    body, html {
        margin: 0;
        padding: 0;
        font-family: 'Arial', sans-serif;
        background-color: var(--background-color);
        color: var(--text-color);
        height: 100%;
        overflow: hidden;
    }

    .hub {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        background-color: rgba(10, 10, 10, 0.9);
        padding: 15px 26px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        z-index: 1000;
        border-bottom: 1px solid var(--border-color);
        transition: transform 0.3s ease-in-out;
    }

    .hub.hidden {
        transform: translateY(-100%);
    }

    .hub-logo {
        font-size: 24px;
        font-weight: bold;
        color: var(--primary-color);
        position: relative;
    }

    .nsfw-bubbles {
        position: absolute;
        width: 100%;
        height: 100%;
        pointer-events: none;
    }

    .bubble {
        position: absolute;
        background-color: var(--primary-color);
        border-radius: 50%;
        opacity: 0;
        animation: bubble 2s ease-out;
    }

    @keyframes bubble {
        0% {
            transform: scale(0) translateY(0);
            opacity: 1;
        }
        100% {
            transform: scale(1) translateY(-50px);
            opacity: 0;
        }
    }

    .search-container {
        display: flex;
        align-items: center;
        flex-grow: 0.5;
        margin: 0 26px;
    }

    .search-bar {
        flex-grow: 1;
        padding: 10px 20px;
        border: none;
        border-radius: 26px;
        background-color: var(--secondary-color);
        color: var(--text-color);
        font-size: 16px;
        width: 50%;
    }

    .filter-btn, .refresh-btn {
        background-color: var(--primary-color);
        border: none;
        width: 36px;
        height: 36px;
        border-radius: 50%;
        margin-left: 13px;
        cursor: pointer;
        display: flex;
        justify-content: center;
        align-items: center;
        transition: background-color 0.3s ease;
    }

    .filter-btn:hover, .refresh-btn:hover {
        background-color: #c73a50;
    }

    .filter-btn img, .refresh-btn img {
        width: 22px;
        height: 22px;
    }

    .settings-btn {
        background-color: transparent;
        border: none;
        cursor: pointer;
        padding: 10px;
    }

    .settings-btn svg {
        width: 24px;
        height: 24px;
        fill: var(--primary-color);
    }

    .filter-section {
        display: none;
        position: fixed;
        top: 60px;
        left: 0;
        right: 0;
        background-color: rgba(10, 10, 10, 0.9);
        padding: 20px;
        z-index: 999;
        border-bottom: 1px solid var(--border-color);
        transition: transform 0.3s ease-in-out;
    }

    .filter-section.hidden {
        transform: translateY(-100%);
    }

    .filter-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
        gap: 8px;
    }

    .filter-option {
        margin-bottom: 10px;
    }

    .filter-option label {
        display: block;
        margin-bottom: 5px;
        color: var(--primary-color);
        font-weight: bold;
    }

    .custom-select {
        position: relative;
        width: 100%;
        max-width: 200px;
    }

    .custom-select select {
        display: block;
        width: 100%;
        padding: 8px 16px;
        font-size: 16px;
        color: var(--text-color);
        background-color: var(--secondary-color);
        border: 1px solid var(--primary-color);
        border-radius: 4px;
        appearance: none;
        cursor: pointer;
    }

    .custom-select::after {
        content: '\25BC';
        position: absolute;
        top: 50%;
        right: 10px;
        transform: translateY(-50%);
        color: var(--primary-color);
        pointer-events: none;
    }

    .category-buttons {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: 20px;
    }

    .category-btn {
        background-color: var(--secondary-color);
        color: var(--text-color);
        border: 1px solid var(--primary-color);
        padding: 8px 16px;
        border-radius: 20px;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }

    .category-btn:hover,
    .category-btn.active {
        background-color: var(--primary-color);
    }

    .settings-modal {
        display: none;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: var(--secondary-color);
        padding: 26px;
        border-radius: 10px;
        z-index: 1001;
        border: 1px solid var(--border-color);
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .settings-option {
        display: flex;
        align-items: center;
        margin-bottom: 20px;
    }

    .settings-option label {
        margin-left: 15px;
        font-size: 16px;
    }

    .settings-title {
        font-size: 24px;
        font-weight: bold;
        color: var(--primary-color);
        margin-bottom: 20px;
    }

    .custom-checkbox {
        width: 20px;
        height: 20px;
        background-color: var(--secondary-color);
        border: 2px solid var(--primary-color);
        border-radius: 4px;
        display: inline-block;
        position: relative;
        cursor: pointer;
    }

    .custom-checkbox::after {
        content: '';
        position: absolute;
        display: none;
        left: 6px;
        top: 2px;
        width: 5px;
        height: 10px;
        border: solid var(--primary-color);
        border-width: 0 2px 2px 0;
        transform: rotate(45deg);
    }

    .settings-option input[type="checkbox"] {
        display: none;
    }

    .settings-option input[type="checkbox"]:checked + .custom-checkbox::after {
        display: block;
    }

    .container {
        height: 100%;
        overflow-y: scroll;
        scroll-snap-type: y mandatory;
        position: relative;
        scrollbar-width: none;
        -ms-overflow-style: none;
        scroll-behavior: smooth;
    }

    .container::-webkit-scrollbar {
        display: none;
    }

    .post-container {
        height: 100%;
        scroll-snap-align: start;
        position: relative;
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: var(--background-color);
        border: 1px solid var(--border-color);
    }

    .post-content {
        width: 100%;
        height: 100%;
        object-fit: contain;
    }

    .actions {
        position: absolute;
        right: 40px;
        bottom: 100px;
        display: flex;
        flex-direction: column;
        align-items: center;
        opacity: 1;
        transition: opacity 0.3s ease;
    }

    .actions.hidden {
        opacity: 0;
    }

    .action-btn {
        background: none;
        border: none;
        color: var(--text-color);
        font-size: 24px;
        margin: 10px 0;
        cursor: pointer;
        transition: color 0.3s ease;
    }

    .action-btn:hover {
        color: var(--primary-color);
    }

    .action-count {
        font-size: 14px;
        margin-top: 5px;
    }

    .user-info {
        position: absolute;
        left: 20px;
        bottom: 20px;
    }

    .username {
        font-weight: bold;
        font-size: 18px;
        margin-bottom: 5px;
    }

    .description {
        font-size: 14px;
        max-width: 250px;
        cursor: pointer;
    }

    .description.truncated::after {
        content: '...';
    }

    .subreddit-info {
        position: absolute;
        left: 20px;
        bottom: 80px;
        font-size: 16px;
        cursor: pointer;
        color: var(--primary-color);
    }

    .subreddit-info:hover {
        text-decoration: underline;
    }

    .overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 1000;
    }

    .loading-animation {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 50px;
        height: 50px;
        border: 3px solid var(--background-color);
        border-top: 3px solid var(--primary-color);
        border-radius: 50%;
        animation: spin 1s linear infinite;
    }

    @keyframes spin {
        0% { transform: translate(-50%, -50%) rotate(0deg); }
        100% { transform: translate(-50%, -50%) rotate(360deg); }
    }

    .search-icon {
        position: fixed;
        top: 20px;
        right: 20px;
        background-color: var(--primary-color);
        border: none;
        width: 36px;
        height: 36px;
        border-radius: 50%;
        cursor: pointer;
        display: flex;
        justify-content: center;
        align-items: center;
        transition: background-color 0.3s ease;
        z-index: 1000;
    }

    .search-icon:hover {
        background-color: #c73a50;
    }

    .search-icon img {
        width: 22px;
        height: 22px;
    }

    .gallery-container {
        position: relative;
        width: 100%;
        height: 100%;
        overflow: hidden;
    }

    .gallery-image {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: contain;
        transition: transform 0.3s ease;
    }

    .gallery-counter {
        position: absolute;
        top: 20px;
        right: 20px;
        background-color: rgba(0, 0, 0, 0.5);
        color: white;
        padding: 5px 10px;
        border-radius: 15px;
        font-size: 14px;
    }

    .gallery-nav {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        background-color: rgba(0, 0, 0, 0.5);
        color: white;
        padding: 10px;
        cursor: pointer;
        font-size: 24px;
        user-select: none;
    }

    .gallery-nav.prev {
        left: 20px;
    }

    .gallery-nav.next {
        right: 20px;
    }

    .immersive-btn {
        background-color: var(--primary-color);
        color: var(--text-color);
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
        margin-top: 20px;
    }

    .immersive-btn:hover {
        background-color: #c73a50;
    }

    .video-player-hub {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        background-color: rgba(10, 10, 10, 0.9);
        padding: 10px;
        display: none;
    }

    .video-progress-bar {
        width: 100%;
        height: 5px;
        background-color: var(--secondary-color);
        margin-bottom: 10px;
        cursor: pointer;
    }

    .video-progress {
        height: 100%;
        background-color: var(--primary-color);
        width: 0;
    }

    .video-controls {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .video-control-btn {
        background: none;
        border: none;
        color: var(--text-color);
        font-size: 18px;
        cursor: pointer;
        padding: 5px;
    }

    .video-control-btn:hover {
        color: var(--primary-color);
    }

    .video-time {
        font-size: 14px;
    }

    .welcome-hub {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: var(--secondary-color);
        padding: 40px;
        border-radius: 10px;
        z-index: 1002;
        text-align: center;
        max-width: 80%;
        width: 400px;
    }

    .welcome-hub h2 {
        color: var(--primary-color);
        margin-bottom: 20px;
    }

    .welcome-hub button {
        background-color: var(--primary-color);
        color: var(--text-color);
        border: none;
        padding: 10px 20px;
        margin: 10px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
    }

    .welcome-hub button:hover {
        background-color: #c73a50;
    }

    .welcome-hub button:disabled {
        background-color: #666;
        cursor: not-allowed;
    }

    .subreddit-selection {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 10px;
        margin-top: 20px;
    }

    .subreddit-btn {
        background-color: var(--secondary-color);
        color: var(--text-color);
        border: 1px solid var(--primary-color);
        padding: 5px 10px;
        border-radius: 15px;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }

    .subreddit-btn.selected {
        background-color: var(--primary-color);
    }

    .glow {
        animation: glow 1s ease-in-out infinite alternate;
    }

    @keyframes glow {
        from {
            text-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 15px var(--primary-color), 0 0 20px var(--primary-color), 0 0 35px var(--primary-color), 0 0 40px var(--primary-color), 0 0 50px var(--primary-color);
        }
        to {
            text-shadow: 0 0 10px #fff, 0 0 20px #fff, 0 0 30px var(--primary-color), 0 0 40px var(--primary-color), 0 0 50px var(--primary-color), 0 0 60px var(--primary-color), 0 0 70px var(--primary-color);
        }
    }

    .pulse {
        animation: pulse 2s infinite;
    }

    @keyframes pulse {
        0% {
            transform: scale(0.95);
            box-shadow: 0 0 0 0 rgba(233, 69, 96, 0.7);
        }
        70% {
            transform: scale(1);
            box-shadow: 0 0 0 10px rgba(233, 69, 96, 0);
        }
        100% {
            transform: scale(0.95);
            box-shadow: 0 0 0 0 rgba(233, 69, 96, 0);
        }
    }

    .uwu-btn {
        background-color: #7200ff;
        border: none;
        width: 36px;
        height: 36px;
        border-radius: 50%;
        cursor: pointer;
        display: flex;
        justify-content: center;
        align-items: center;
        transition: background-color 0.3s ease;
        margin-top: 20px;
    }

    .uwu-btn img {
        width: 24px;
        height: 24px;
    }

    .uwu-bubble {
        position: absolute;
        background-color: #7200ff;
        border-radius: 50%;
        opacity: 0;
        animation: uwuBubble 2s ease-out;
    }

    @keyframes uwuBubble {
        0% {
            transform: scale(0) translateY(0);
            opacity: 1;
        }
        100% {
            transform: scale(1) translateY(-50px);
            opacity: 0;
        }
    }

    .uwu-prompt {
        display: none;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: #1a1a1a;
        color: #fff;
        padding: 20px;
        border-radius: 10px;
        text-align: center;
        z-index: 1003;
    }

    .uwu-prompt h3 {
        color: #7200ff;
        margin-bottom: 20px;
    }

    .uwu-prompt button {
        background-color: #7200ff;
        color: #fff;
        border: none;
        padding: 10px 20px;
        margin: 0 10px;
        border-radius: 5px;
        cursor: pointer;
    }

    .uwu-mode {
        --primary-color: #7200ff;
    }

    .uwu-mode .hub-logo,
    .uwu-mode .filter-btn,
    .uwu-mode .refresh-btn,
    .uwu-mode .settings-btn svg,
    .uwu-mode .category-btn:hover,
    .uwu-mode .category-btn.active,
    .uwu-mode .settings-title,
    .uwu-mode .custom-checkbox,
    .uwu-mode .action-btn:hover,
    .uwu-mode .subreddit-info,
    .uwu-mode .loading-animation,
    .uwu-mode .search-icon,
    .uwu-mode .video-progress,
    .uwu-mode .video-control-btn:hover,
    .uwu-mode .welcome-hub h2,
    .uwu-mode .welcome-hub button,
    .uwu-mode .subreddit-btn.selected {
        color: #7200ff;
        border-color: #7200ff;
    }

    .uwu-mode .filter-btn:hover,
    .uwu-mode .refresh-btn:hover,
    .uwu-mode .search-icon:hover,
    .uwu-mode .welcome-hub button:hover {
        background-color: #5900cc;
    }
</style>
</head>
<body>
    <div class="hub">
        <div class="hub-logo">
            Mokie
            <div class="nsfw-bubbles"></div>
        </div>
        <div class="search-container">
            <input type="text" class="search-bar" placeholder="Search subreddits...">
            <button class="filter-btn">
                <img src="https://cdn-icons-png.flaticon.com/256/6372/6372641.png" alt="Search Icon">
            </button>
            <button class="refresh-btn">
                <img src="https://www.flaticon.com/svg/vstatic/svg/3916/3916984.svg?token=exp=1721927645~hmac=4db5c2394409f65bfbf08fc1c6f3c580" alt="Refresh Icon">
            </button>
        </div>
        <button class="settings-btn">
            <svg viewBox="0 0 24 24">
                <path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"></path>
            </svg>
        </button>
    </div>

    <button class="search-icon">
        <img src="https://cdn-icons-png.flaticon.com/256/6372/6372641.png" alt="Search Icon">
    </button>

    <div class="filter-section">
        <div class="filter-grid">
            <div class="filter-option">
                <label for="sortBy">Sort by:</label>
                <div class="custom-select">
                    <select id="sortBy">
                        <option value="hot">Hot</option>
                        <option value="new">New</option>
                        <option value="top">Top</option>
                        <option value="rising">Rising</option>
                    </select>
                </div>
            </div>
            <div class="filter-option">
                <label for="timeRange">Time range:</label>
                <div class="custom-select">
                    <select id="timeRange">
                        <option value="hour">Past hour</option>
                        <option value="day">Past 24 hours</option>
                        <option value="week">Past week</option>
                        <option value="month">Past month</option>
                        <option value="year">Past year</option>
                        <option value="all">All time</option>
                    </select>
                </div>
            </div>
            <div class="filter-option">
                <label for="contentType">Content type:</label>
                <div class="custom-select">
                    <select id="contentType">
                        <option value="all">All</option>
                        <option value="image">Images only</option>
                        <option value="video">Videos only</option>
                        <option value="gallery">Galleries only</option>
                        <option value="gif_video">Gifs & Videos</option>
                    </select>
                </div>
            </div>
        </div>
        <div class="filter-option">
            <label>Categories:</label>
            <div class="category-buttons">
                <!-- Categories will be dynamically populated here -->
            </div>
        </div>
    </div>

    <div class="overlay"></div>

    <div class="settings-modal">
        <div class="settings-title">Settings</div>
        <div class="settings-option">
            <input type="checkbox" id="darkMode" checked>
            <label for="darkMode" class="custom-checkbox"></label>
            <label for="darkMode">Dark Mode</label>
        </div>
        <div class="settings-option">
            <input type="checkbox" id="autoplayVideos" checked>
            <label for="autoplayVideos" class="custom-checkbox"></label>
            <label for="autoplayVideos">Autoplay Videos</label>
        </div>
        <div class="settings-option">
            <input type="checkbox" id="showNSFW">
            <label for="showNSFW" class="custom-checkbox"></label>
            <label for="showNSFW">Show NSFW Content</label>
        </div>
        <button class="immersive-btn">Immersive Viewer</button>
        <button class="uwu-btn">
            <img src="https://cdn-icons-png.flaticon.com/128/5100/5100789.png" alt="UwU Icon">
        </button>
    </div>

    <div class="container">
        <!-- Content will be dynamically loaded here -->
    </div>

    <div class="video-player-hub">
        <div class="video-progress-bar">
            <div class="video-progress"></div>
        </div>
        <div class="video-controls">
            <button class="video-control-btn play-pause-btn">
                <i class="fas fa-play"></i>
            </button>
            <button class="video-control-btn mute-btn">
                <i class="fas fa-volume-up"></i>
            </button>
            <span class="video-time">0:00 / 0:00</span>
        </div>
    </div>

    <div class="welcome-hub" style="display: none;">
        <h2>Are you a first time user?</h2>
        <button id="welcomeYesBtn">Yes</button>
        <button id="welcomeNoBtn">No</button>
    </div>

    <div class="uwu-prompt">
        <h3>Feeling UwU?</h3>
        <button id="uwuYesBtn">Yes</button>
        <button id="uwuNoBtn">No</button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"></script>
    <script src="https://kit.fontawesome.com/your-fontawesome-kit.js" crossorigin="anonymous"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const container = document.querySelector('.container');
            const searchBar = document.querySelector('.search-bar');
            const filterBtn = document.querySelector('.filter-btn');
            const refreshBtn = document.querySelector('.refresh-btn');
            const filterSection = document.querySelector('.filter-section');
            const settingsBtn = document.querySelector('.settings-btn');
            const settingsModal = document.querySelector('.settings-modal');
            const overlay = document.querySelector('.overlay');
            const darkModeToggle = document.getElementById('darkMode');
            const autoplayToggle = document.getElementById('autoplayVideos');
            const nsfwToggle = document.getElementById('showNSFW');
            const sortBySelect = document.getElementById('sortBy');
            const timeRangeSelect = document.getElementById('timeRange');
            const contentTypeSelect = document.getElementById('contentType');
            const categoryButtons = document.querySelector('.category-buttons');
            const hubLogo = document.querySelector('.hub-logo');
            const nsfwBubbles = document.querySelector('.nsfw-bubbles');
            const hub = document.querySelector('.hub');
            const searchIcon = document.querySelector('.search-icon');
            const immersiveBtn = document.querySelector('.immersive-btn');
            const videoPlayerHub = document.querySelector('.video-player-hub');
            const videoProgressBar = document.querySelector('.video-progress-bar');
            const videoProgress = document.querySelector('.video-progress');
            const playPauseBtn = document.querySelector('.play-pause-btn');
            const muteBtn = document.querySelector('.mute-btn');
            const videoTime = document.querySelector('.video-time');
            const welcomeHub = document.querySelector('.welcome-hub');
            const welcomeYesBtn = document.getElementById('welcomeYesBtn');
            const welcomeNoBtn = document.getElementById('welcomeNoBtn');
            const uwuBtn = document.querySelector('.uwu-btn');
            const uwuPrompt = document.querySelector('.uwu-prompt');
            const uwuYesBtn = document.getElementById('uwuYesBtn');
            const uwuNoBtn = document.getElementById('uwuNoBtn');

            let isScrolling = false;
            let startY;
            let startTop;
            let selectedCategory = 'all';
            let currentSubreddit = '';
            let userPreferences = {
                likedPosts: [],
                searchHistory: [],
                viewedSubreddits: [],
                interactionHistory: [],
                selectedSubreddits: [],
                selectedMatureSubreddits: [],
                isFirstTimeUser: true,
                uwuMode: false
            };

            let hubTimer;
            let isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
            let currentVideoElement = null;

            const safeSubreddits = ['funny', 'pics', 'aww', 'gaming', 'food', 'space', 'science', 'music', 'movies', 'art', 'EarthPorn', 'wholesome', 'memes', 'cats', 'dogs'];
            const nsfwSubreddits = ['gonewild', 'nsfw', 'RealGirls', 'NSFW_GIF', 'holdthemoan', 'LegalTeens', 'cumsluts', 'AsiansGoneWild', 'GoneWildCurvy', 'amateur', 'PetiteGoneWild', 'Boobies', 'milf', 'ass', 'pussy'];
            const hentaiSubreddits = ['hentai', 'ecchi', 'rule34', 'MonsterGirl', 'yuri', 'ahegao', 'Tentai', 'HentaiBondage', 'hentaibondage', 'hentaimemes', 'WaifusOnCouch'];

            function setCookie(name, value, days) {
                let expires = "";
                if (days) {
                    let date = new Date();
                    date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
                    expires = "; expires=" + date.toUTCString();
                }
                document.cookie = name + "=" + (value || "") + expires + "; path=/";
            }

            function getCookie(name) {
                let nameEQ = name + "=";
                let ca = document.cookie.split(';');
                for (let i = 0; i < ca.length; i++) {
                    let c = ca[i];
                    while (c.charAt(0) == ' ') c = c.substring(1, c.length);
                    if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
                }
                return null;
            }

            function hideHub() {
                hub.classList.add('hidden');
                filterSection.classList.add('hidden');
                searchIcon.style.display = 'flex';
            }

            function showHub() {
                hub.classList.remove('hidden');
                filterSection.classList.remove('hidden');
                searchIcon.style.display = 'none';
            }

            if (isMobile) {
                document.addEventListener('touchstart', () => {
                    clearTimeout(hubTimer);
                    showHub();
                    hubTimer = setTimeout(hideHub, 2000);
                });
            } else {
                document.addEventListener('mousemove', (e) => {
                    clearTimeout(hubTimer);
                    if (e.clientY < 100) {
                        showHub();
                    } else {
                        hubTimer = setTimeout(hideHub, 2000);
                    }
                });
            }

            searchIcon.addEventListener('click', showHub);

            container.addEventListener('touchstart', (e) => {
                startY = e.touches[0].pageY;
                startTop = container.scrollTop;
                isScrolling = true;
            });

            container.addEventListener('touchmove', (e) => {
                if (!isScrolling) return;
                e.preventDefault();
                const y = e.touches[0].pageY;
                const walk = (y - startY) * 2;
                container.scrollTop = startTop - walk;
            });

            container.addEventListener('touchend', () => {
                isScrolling = false;
            });

            filterBtn.addEventListener('click', () => {
                filterSection.style.display = filterSection.style.display === 'none' ? 'block' : 'none';
            });

            refreshBtn.addEventListener('click', () => {
                generateFYPFeed(true);
            });

            settingsBtn.addEventListener('click', () => {
                settingsModal.style.display = 'block';
                overlay.style.display = 'block';
            });

            overlay.addEventListener('click', () => {
                settingsModal.style.display = 'none';
                overlay.style.display = 'none';
                uwuPrompt.style.display = 'none';
            });

            darkModeToggle.addEventListener('change', toggleDarkMode);
            autoplayToggle.addEventListener('change', toggleAutoplay);
            nsfwToggle.addEventListener('change', toggleNSFW);

            searchBar.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    const searchTerm = this.value;
                    userPreferences.searchHistory.push(searchTerm);
                    searchReddit(searchTerm);
                }
            });

            sortBySelect.addEventListener('change', () => applyFilters());
            timeRangeSelect.addEventListener('change', () => applyFilters());
            contentTypeSelect.addEventListener('change', () => applyFilters());

            function updateCategoryButtons() {
                categoryButtons.innerHTML = '';
                const categories = userPreferences.uwuMode ? hentaiSubreddits : (nsfwToggle.checked ? nsfwSubreddits : safeSubreddits);
                categories.forEach(category => {
                    const button = document.createElement('button');
                    button.className = 'category-btn';
                    button.textContent = category;
                    button.dataset.category = category;
                    button.addEventListener('click', () => {
                        categoryButtons.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active'));
                        button.classList.add('active');
                        selectedCategory = category;
                        applyFilters();
                    });
                    categoryButtons.appendChild(button);
                });
            }

            function applyFilters() {
                const query = searchBar.value;
                const sortBy = sortBySelect.value;
                const timeRange = timeRangeSelect.value;
                const contentType = contentTypeSelect.value;
                searchReddit(query, sortBy, timeRange, contentType, selectedCategory);
            }

function searchReddit(query, sortBy = 'hot', timeRange = 'all', contentType = 'all', category = 'all') {
    const nsfwOnly = nsfwToggle.checked || userPreferences.uwuMode;
    let url;
    
    if (userPreferences.uwuMode) {
        // Only search hentai subreddits in UwU mode
        const hentaiQuery = hentaiSubreddits.join('+');
        url = `https://www.reddit.com/r/${hentaiQuery}/search.json?q=${query}&restrict_sr=on&include_over_18=on&sort=${sortBy}&t=${timeRange}&limit=35`;
    } else if (query.startsWith('r/')) {
        // Search within a specific subreddit
        const subreddit = query.slice(2);
        url = `https://www.reddit.com/r/${subreddit}/${sortBy}.json?t=${timeRange}&limit=35`;
    } else {
        // Search across all subreddits
        url = `https://www.reddit.com/search.json?q=${query}+nsfw:${nsfwOnly ? 'yes' : 'no'}&sort=${sortBy}&t=${timeRange}&include_over_18=${nsfwOnly}&limit=35`;
    }
    
    showLoadingAnimation();
    
    axios.get(url)
        .then(response => {
            const posts = response.data.data.children;
            container.innerHTML = ''; // Clear existing content
            posts.forEach(post => {
                const postData = post.data;
                if (shouldDisplayPost(postData, contentType)) {
                    const postElement = createPostElement(postData);
                    if (postElement) {
                        container.appendChild(postElement);
                    }
                }
            });
            hideLoadingAnimation();
        })
        .catch(error => {
            console.error('Error fetching data:', error);
            hideLoadingAnimation();
        });
}

            function shouldDisplayPost(postData, contentType) {
                if (postData.is_self || postData.selftext) {
                    return false; // Exclude discussion and story posts
                }
                switch (contentType) {
                    case 'image':
                        return postData.post_hint === 'image';
                    case 'video':
                        return postData.is_video;
                    case 'gallery':
                        return postData.is_gallery;
                    case 'gif_video':
                        return postData.is_video || (postData.post_hint === 'image' && postData.url.endsWith('.gif'));
                    default:
                        return postData.post_hint === 'image' || postData.is_video || postData.is_gallery || (postData.post_hint === 'rich:video');
                }
            }

            function createPostElement(postData) {
                const postElement = document.createElement('div');
                postElement.className = 'post-container';
                
               let contentHtml;
    if (postData.is_video) {
        contentHtml = `
            <video class="post-content" ${autoplayToggle.checked ? 'autoplay' : ''} loop muted playsinline>
                <source src="${postData.media.reddit_video.fallback_url}" type="video/mp4">
            </video>
        `;
    } else if (postData.post_hint === 'image') {
        contentHtml = `<img class="post-content" src="${postData.url}" alt="${postData.title}" loading="lazy">`;
    } else if (postData.is_gallery) {
        contentHtml = createGalleryHtml(postData);
    } else if (postData.post_hint === 'rich:video') {
        // Extract video URL from oembed data if available
        const videoUrl = postData.media?.oembed?.thumbnail_url?.replace('jpg', 'mp4') || postData.url;
        contentHtml = `<video class="post-content" ${autoplayToggle.checked ? 'autoplay' : ''} loop muted playsinline>
            <source src="${videoUrl}" type="video/mp4">
        </video>`;
    } else if (postData.domain.includes('redgifs.com') || postData.domain.includes('streamable.com')) {
        // For Redgifs and Streamable, use their oEmbed API to get the video URL
        fetchVideoUrl(postData.url).then(videoUrl => {
            if (videoUrl) {
                postElement.querySelector('.post-content').outerHTML = `
                    <video class="post-content" ${autoplayToggle.checked ? 'autoplay' : ''} loop muted playsinline>
                        <source src="${videoUrl}" type="video/mp4">
                    </video>
                `;
            }
        });
        contentHtml = '<div class="post-content">Loading content...</div>';
    } else {
        return null; // Skip this post if it doesn't match any of the above types
    }

                const truncatedTitle = postData.title.length > 41 ? postData.title.slice(0, 41) + '...' : postData.title;

                postElement.innerHTML = `
                    ${contentHtml}
                    <div class="actions hidden">
                        <button class="action-btn like-btn" data-post-id="${postData.id}">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                            </svg>
                            <div class="action-count">${postData.ups}</div>
                        </button>
                        <button class="action-btn">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                            </svg>
                            <div class="action-count">${postData.num_comments}</div>
                        </button>
                        <button class="action-btn">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="18" cy="5" r="3"></circle>
                                <circle cx="6" cy="12" r="3"></circle>
                                <circle cx="18" cy="19" r="3"></circle>
                                <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
                                <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
                            </svg>
                            <div class="action-count">Share</div>
                        </button>
                        <button class="action-btn video-options-btn">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="12" cy="12" r="1"></circle>
                                <circle cx="12" cy="5" r="1"></circle>
                                <circle cx="12" cy="19" r="1"></circle>
                            </svg>
                        </button>
                    </div>
                    <div class="subreddit-info">${postData.subreddit_name_prefixed}</div>
                    <div class="user-info">
                        <div class="username">u/${postData.author}</div>
                        <div class="description${postData.title.length > 41 ? ' truncated' : ''}">${truncatedTitle}</div>
                    </div>
                `;

                const subredditInfo = postElement.querySelector('.subreddit-info');
                subredditInfo.addEventListener('click', () => {
                    currentSubreddit = postData.subreddit;
                    userPreferences.viewedSubreddits.push(currentSubreddit);
                    searchBar.value = currentSubreddit;
                    applyFilters();
                });

                const likeBtn = postElement.querySelector('.like-btn');
                likeBtn.addEventListener('click', () => {
                    const postId = likeBtn.dataset.postId;
                    if (!userPreferences.likedPosts.includes(postId)) {
                        userPreferences.likedPosts.push(postId);
                        likeBtn.classList.add('liked');
                    } else {
                        userPreferences.likedPosts = userPreferences.likedPosts.filter(id => id !== postId);
                        likeBtn.classList.remove('liked');
                    }
                    updateUserPreferences();
                });

                const description = postElement.querySelector('.description');
                description.addEventListener('click', () => {
                    if (postData.title.length > 41) {
                        description.textContent = description.textContent === truncatedTitle ? postData.title : truncatedTitle;
                        description.classList.toggle('truncated');
                    }
                });

                const actions = postElement.querySelector('.actions');
                let timeout;
                postElement.addEventListener('click', () => {
                    actions.classList.remove('hidden');
                    clearTimeout(timeout);
                    timeout = setTimeout(() => {
                        actions.classList.add('hidden');
                    }, 5000);
                });

                if (postData.is_gallery) {
                    initializeGallery(postElement);
                }

                const videoOptionsBtn = postElement.querySelector('.video-options-btn');
                if (videoOptionsBtn) {
                    videoOptionsBtn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const videoElement = postElement.querySelector('video');
                        if (videoElement) {
                            showVideoPlayerHub(videoElement);
                        }
                    });
                }

                return postElement;
            }

            function createGalleryHtml(postData) {
                const galleryItems = postData.gallery_data.items;
                let galleryHtml = `
                    <div class="gallery-container">
                        <div class="gallery-counter">1/${galleryItems.length}</div>
                `;

                galleryItems.forEach((item, index) => {
                    const mediaId = item.media_id;
                    const imageUrl = postData.media_metadata[mediaId].s.u;
                    galleryHtml += `
                        <img class="gallery-image" src="${imageUrl}" alt="Gallery image ${index + 1}" style="transform: translateX(${index * 100}%);">
                    `;
                });

                galleryHtml += `
                    <div class="gallery-nav prev">&lt;</div>
                    <div class="gallery-nav next">&gt;</div>
                    </div>
                `;

                return galleryHtml;
            }

            async function fetchVideoUrl(url) {
    if (url.includes('redgifs.com')) {
        const oEmbedUrl = `https://api.redgifs.com/v2/oembed?url=${encodeURIComponent(url)}`;
        try {
            const response = await fetch(oEmbedUrl);
            const data = await response.json();
            return data.url;
        } catch (error) {
            console.error('Error fetching Redgifs video:', error);
            return null;
        }
    } else if (url.includes('streamable.com')) {
        const oEmbedUrl = `https://api.streamable.com/oembed.json?url=${encodeURIComponent(url)}`;
        try {
            const response = await fetch(oEmbedUrl);
            const data = await response.json();
            return data.thumbnail_url.replace('jpg', 'mp4');
        } catch (error) {
            console.error('Error fetching Streamable video:', error);
            return null;
        }
    }
    return null;
}

            function initializeGallery(postElement) {
                const galleryContainer = postElement.querySelector('.gallery-container');
                if (!galleryContainer) return;

                const images = galleryContainer.querySelectorAll('.gallery-image');
                const counter = galleryContainer.querySelector('.gallery-counter');
                const prevBtn = galleryContainer.querySelector('.gallery-nav.prev');
                const nextBtn = galleryContainer.querySelector('.gallery-nav.next');
                let currentIndex = 0;

                function updateGallery() {
                    images.forEach((img, index) => {
                        img.style.transform = `translateX(${(index - currentIndex) * 100}%)`;
                    });
                    counter.textContent = `${currentIndex + 1}/${images.length}`;
                }

                prevBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    currentIndex = (currentIndex - 1 + images.length) % images.length;
                    updateGallery();
                });

                nextBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    currentIndex = (currentIndex + 1) % images.length;
                    updateGallery();
                });

                let startX, moveX;
                galleryContainer.addEventListener('touchstart', (e) => {
                    startX = e.touches[0].clientX;
                });

                galleryContainer.addEventListener('touchmove', (e) => {
                    moveX = e.touches[0].clientX;
                });

                galleryContainer.addEventListener('touchend', () => {
                    if (startX - moveX > 50) {
                        nextBtn.click();
                    } else if (moveX - startX > 50) {
                        prevBtn.click();
                    }
                });
            }

            function toggleDarkMode() {
                document.body.classList.toggle('light-mode', !darkModeToggle.checked);
            }

            function toggleAutoplay() {
                const videos = document.querySelectorAll('video');
                videos.forEach(video => {
                    if (autoplayToggle.checked) {
                        video.setAttribute('autoplay', '');
                    } else {
                        video.removeAttribute('autoplay');
                    }
                });
            }

            function toggleNSFW() {
                updateCategoryButtons();
                applyFilters();
                if (nsfwToggle.checked) {
                    createBubbles();
                } else {
                    nsfwBubbles.innerHTML = '';
                }
            }

            function createBubbles() {
                nsfwBubbles.innerHTML = '';
                for (let i = 0; i < 20; i++) {
                    const bubble = document.createElement('div');
                    bubble.className = 'bubble';
                    bubble.style.left = `${Math.random() * 100}%`;
                    bubble.style.animationDelay = `${Math.random() * 2}s`;
                    bubble.style.width = `${Math.random() * 10 + 5}px`;
                    bubble.style.height = bubble.style.width;
                    nsfwBubbles.appendChild(bubble);
                }
            }

            function updateUserPreferences() {
                localStorage.setItem('userPreferences', JSON.stringify(userPreferences));
                setCookie('userPreferences', JSON.stringify(userPreferences), 30);
            }

            function loadUserPreferences() {
                const savedPreferences = localStorage.getItem('userPreferences') || getCookie('userPreferences');
                if (savedPreferences) {
                    userPreferences = JSON.parse(savedPreferences);
                    if (!userPreferences.isFirstTimeUser) {
                        welcomeHub.style.display = 'none';
                        generateFYPFeed();
                    } else {
                        showWelcomeHub();
                    }
                } else {
                    showWelcomeHub();
                }
            }

            function showWelcomeHub() {
                welcomeHub.style.display = 'block';
                overlay.style.display = 'block';
            }

            function generateFYPFeed(forceRefresh = false) {
                const seed = Math.floor(Math.random() * 1000000);
                const likedSubreddits = userPreferences.likedPosts.map(postId => {
                    // Here you would normally fetch the subreddit for each liked post
                    // For this example, we'll just use a placeholder
                    return 'placeholder_subreddit';
                });

                const viewedSubreddits = userPreferences.viewedSubreddits;
                const searchTerms = userPreferences.searchHistory;

                // Combine and deduplicate the data
                const userInterests = [...new Set([...likedSubreddits, ...viewedSubreddits, ...searchTerms, ...userPreferences.selectedSubreddits, ...userPreferences.selectedMatureSubreddits])];

                // Generate a query based on user interests
                const query = userInterests.join(' OR ');

                // Fetch posts based on user interests
                const sortBy = sortBySelect.value;
                const timeRange = timeRangeSelect.value;
                const contentType = contentTypeSelect.value;

                if (forceRefresh) {
                    // If it's a forced refresh, we'll use a random selection of interests
                    const randomInterests = userInterests.sort(() => 0.5 - Math.random()).slice(0, 5);
                    const randomQuery = randomInterests.join(' OR ');
                    searchReddit(randomQuery, sortBy, timeRange, contentType, 'all', seed);
                } else {
                    searchReddit(query, sortBy, timeRange, contentType, 'all', seed);
                }
            }

            function showLoadingAnimation() {
                const loadingAnimation = document.createElement('div');
                loadingAnimation.className = 'loading-animation';
                container.appendChild(loadingAnimation);
            }

            function hideLoadingAnimation() {
                const loadingAnimation = container.querySelector('.loading-animation');
                if (loadingAnimation) {
                    loadingAnimation.remove();
                }
            }

            function showVideoPlayerHub(videoElement) {
                currentVideoElement = videoElement;
                videoPlayerHub.style.display = 'block';
                updateVideoProgress();
                updatePlayPauseButton();
                updateMuteButton();
            }

            function hideVideoPlayerHub() {
                videoPlayerHub.style.display = 'none';
                currentVideoElement = null;
            }

            function updateVideoProgress() {
                if (currentVideoElement) {
                    const progress = (currentVideoElement.currentTime / currentVideoElement.duration) * 100;
                    videoProgress.style.width = `${progress}%`;
                    videoTime.textContent = `${formatTime(currentVideoElement.currentTime)} / ${formatTime(currentVideoElement.duration)}`;
                }
            }

            function formatTime(timeInSeconds) {
                const minutes = Math.floor(timeInSeconds / 60);
                const seconds = Math.floor(timeInSeconds % 60);
                return `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
            }

            function updatePlayPauseButton() {
                if (currentVideoElement) {
                    playPauseBtn.innerHTML = currentVideoElement.paused ? '<i class="fas fa-play"></i>' : '<i class="fas fa-pause"></i>';
                }
            }

            function updateMuteButton() {
                if (currentVideoElement) {
                    muteBtn.innerHTML = currentVideoElement.muted ? '<i class="fas fa-volume-mute"></i>' : '<i class="fas fa-volume-up"></i>';
                }
            }

            playPauseBtn.addEventListener('click', () => {
                if (currentVideoElement) {
                    if (currentVideoElement.paused) {
                        currentVideoElement.play();
                    } else {
                        currentVideoElement.pause();
                    }
                    updatePlayPauseButton();
                }
            });

            muteBtn.addEventListener('click', () => {
                if (currentVideoElement) {
                    currentVideoElement.muted = !currentVideoElement.muted;
                    updateMuteButton();
                }
            });

            videoProgressBar.addEventListener('click', (e) => {
                if (currentVideoElement) {
                    const rect = videoProgressBar.getBoundingClientRect();
                    const pos = (e.clientX - rect.left) / videoProgressBar.offsetWidth;
                    currentVideoElement.currentTime = pos * currentVideoElement.duration;
                    updateVideoProgress();
                }
            });

            welcomeYesBtn.addEventListener('click', () => {
                welcomeHub.innerHTML = `
                    <h2>Welcome to <span class="glow">Mokie</span></h2>
                `;
                setTimeout(() => {
                    showInterestSelection();
                }, 3000);
            });

            welcomeNoBtn.addEventListener('click', () => {
                userPreferences.isFirstTimeUser = false;
                updateUserPreferences();
                welcomeHub.style.display = 'none';
                overlay.style.display = 'none';
                generateFYPFeed();
            });

            function showInterestSelection() {
                welcomeHub.innerHTML = `
                    <h2>What's your interest?</h2>
                    <div class="subreddit-selection"></div>
                    <button id="interestDoneBtn" disabled>DONE</button>
                    <button id="interestSkipBtn">Skip</button>
                `;

                const subredditSelection = welcomeHub.querySelector('.subreddit-selection');
                const interestDoneBtn = document.getElementById('interestDoneBtn');
                const interestSkipBtn = document.getElementById('interestSkipBtn');

                safeSubreddits.forEach(subreddit => {
                    const btn = document.createElement('button');
                    btn.className = 'subreddit-btn';
                    btn.textContent = subreddit;
                    btn.addEventListener('click', () => {
                        btn.classList.toggle('selected');
                        const selectedCount = subredditSelection.querySelectorAll('.selected').length;
                        interestDoneBtn.disabled = selectedCount < 5;
                    });
                    subredditSelection.appendChild(btn);
                });

                interestDoneBtn.addEventListener('click', () => {
                    const selectedSubreddits = Array.from(subredditSelection.querySelectorAll('.selected')).map(btn => btn.textContent);
                    userPreferences.selectedSubreddits = selectedSubreddits;
                    showMatureContentQuestion();
                });

                interestSkipBtn.addEventListener('click', () => {
                    showMatureContentQuestion();
                });
            }

            function showMatureContentQuestion() {
                welcomeHub.innerHTML = `
                    <h2>Do you like Mature Content? <span class="pulse">+18</span></h2>
                    <button id="matureYesBtn">Yes</button>
                    <button id="matureNoBtn">No</button>
                `;

                const matureYesBtn = document.getElementById('matureYesBtn');
                const matureNoBtn = document.getElementById('matureNoBtn');

                matureYesBtn.addEventListener('click', showMatureSubredditSelection);
                matureNoBtn.addEventListener('click', finishOnboarding);
            }

            function showMatureSubredditSelection() {
                welcomeHub.innerHTML = `
                    <h2>Select Mature Subreddits</h2>
                    <div class="subreddit-selection"></div>
                    <button id="matureDoneBtn" disabled>DONE</button>
                    <button id="matureSkipBtn">Skip</button>
                `;

                const subredditSelection = welcomeHub.querySelector('.subreddit-selection');
                const matureDoneBtn = document.getElementById('matureDoneBtn');
                const matureSkipBtn = document.getElementById('matureSkipBtn');

                nsfwSubreddits.forEach(subreddit => {
                    const btn = document.createElement('button');
                    btn.className = 'subreddit-btn';
                    btn.textContent = subreddit;
                    btn.addEventListener('click', () => {
                        btn.classList.toggle('selected');
                        const selectedCount = subredditSelection.querySelectorAll('.selected').length;
                        matureDoneBtn.disabled = selectedCount < 5;
                    });
                    subredditSelection.appendChild(btn);
                });

                matureDoneBtn.addEventListener('click', () => {
                    const selectedMatureSubreddits = Array.from(subredditSelection.querySelectorAll('.selected')).map(btn => btn.textContent);
                    userPreferences.selectedMatureSubreddits = selectedMatureSubreddits;
                    finishOnboarding();
                });

                matureSkipBtn.addEventListener('click', finishOnboarding);
            }

            function finishOnboarding() {
                welcomeHub.innerHTML = `
                    <h2>Thank you, and Enjoy <span class="glow">Moking</span> Around!</h2>
                `;
                setTimeout(() => {
                    userPreferences.isFirstTimeUser = false;
                    updateUserPreferences();
                    welcomeHub.style.display = 'none';
                    overlay.style.display = 'none';
                    generateFYPFeed();
                }, 3000);
            }

            function toggleUwUMode() {
                userPreferences.uwuMode = !userPreferences.uwuMode;
                document.body.classList.toggle('uwu-mode', userPreferences.uwuMode);
                updateCategoryButtons();
                generateFYPFeed(true);
                updateUserPreferences();
            }

let refreshLongPressTimer;
let isLongPress = false;

refreshBtn.addEventListener('mousedown', startLongPress);
refreshBtn.addEventListener('touchstart', startLongPress);
refreshBtn.addEventListener('mouseup', endLongPress);
refreshBtn.addEventListener('mouseleave', endLongPress);
refreshBtn.addEventListener('touchend', endLongPress);

function startLongPress(e) {
    isLongPress = false;
    refreshLongPressTimer = setTimeout(() => {
        isLongPress = true;
        getSuggestiveContent();
    }, 1000); // Long press threshold: 1 second
}

function endLongPress() {
    clearTimeout(refreshLongPressTimer);
    if (!isLongPress) {
        generateFYPFeed(true);
    }
}

function getSuggestiveContent() {
    const currentPost = document.querySelector('.post-container');
    if (currentPost) {
        const subredditName = currentPost.querySelector('.subreddit-info').textContent.slice(2); // Remove 'r/' prefix
        fetchRelatedSubreddits(subredditName).then(relatedSubs => {
            const query = relatedSubs.join(' OR ');
            searchReddit(query, 'hot', 'all', 'all', 'all');
        });
    }
}

async function fetchRelatedSubreddits(subreddit) {
    try {
        const response = await fetch(`https://www.reddit.com/r/${subreddit}/about.json`);
        const data = await response.json();
        return data.data.advertiser_category.split(',').map(s => s.trim());
    } catch (error) {
        console.error('Error fetching related subreddits:', error);
        return [subreddit]; // Return the original subreddit if fetching fails
    }
}

uwuBtn.addEventListener('click', () => {
    settingsModal.style.display = 'none';
    if (userPreferences.uwuMode) {
        uwuPrompt.innerHTML = `
            <h3>No more UwU?</h3>
            <button id="uwuYesBtn">Yes</button>
            <button id="uwuNoBtn">No</button>
        `;
    } else {
        uwuPrompt.innerHTML = `
            <h3>Feeling UwU?</h3>
            <button id="uwuYesBtn">Yes</button>
            <button id="uwuNoBtn">No</button>
        `;
    }
    uwuPrompt.style.display = 'block';
    overlay.style.display = 'block';
});

uwuPrompt.addEventListener('click', (e) => {
    if (e.target.id === 'uwuYesBtn') {
        toggleUwUMode();
        uwuPrompt.style.display = 'none';
        settingsModal.style.display = 'block';
    } else if (e.target.id === 'uwuNoBtn') {
        uwuPrompt.style.display = 'none';
        settingsModal.style.display = 'block';
    }
});

            function createUwUBubbles() {
                for (let i = 0; i < 20; i++) {
                    const bubble = document.createElement('div');
                    bubble.className = 'uwu-bubble';
                    bubble.style.left = `${Math.random() * 100}%`;
                    bubble.style.animationDelay = `${Math.random() * 2}s`;
                    bubble.style.width = `${Math.random() * 10 + 5}px`;
                    bubble.style.height = bubble.style.width;
                    document.body.appendChild(bubble);
                }
            }

            immersiveBtn.addEventListener('click', () => {
                document.documentElement.requestFullscreen();
                document.body.classList.add('immersive-mode');
            });

            document.addEventListener('fullscreenchange', () => {
                if (!document.fullscreenElement) {
                    document.body.classList.remove('immersive-mode');
                }
            });

            loadUserPreferences();
            updateCategoryButtons();

            if (userPreferences.uwuMode) {
                document.body.classList.add('uwu-mode');
                createUwUBubbles();
            }

            setInterval(() => {
                if (currentVideoElement) {
                    updateVideoProgress();
                }
            }, 1000);
        });
    </script>
</body>
</html>
