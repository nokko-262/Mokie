<html><head><base href="https://Mokie.com">
<title>Mokie Reddit Scroller</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
    :root {
        --primary-color: #e94560;
        --background-color: #0a0a0a;
        --text-color: #ffffff;
        --secondary-color: #1a1a1a;
        --border-color: #000000;
    }

    body, html {
        margin: 0;
        padding: 0;
        font-family: 'Arial', sans-serif;
        background-color: var(--background-color);
        color: var(--text-color);
        height: 100%;
        overflow: hidden;
    }

    .hub {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        background-color: rgba(10, 10, 10, 0.9);
        padding: 15px 26px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        z-index: 1000;
        border-bottom: 1px solid var(--border-color);
        transition: transform 0.3s ease-in-out;
    }

    .hub.hidden {
        transform: translateY(-100%);
    }

    .hub-logo {
        font-size: 24px;
        font-weight: bold;
        color: var(--primary-color);
        position: relative;
    }

    .nsfw-bubbles {
        position: absolute;
        width: 100%;
        height: 100%;
        pointer-events: none;
    }

    .bubble {
        position: absolute;
        background-color: var(--primary-color);
        border-radius: 50%;
        opacity: 0;
        animation: bubble 2s ease-out;
    }

    @keyframes bubble {
        0% {
            transform: scale(0) translateY(0);
            opacity: 1;
        }
        100% {
            transform: scale(1) translateY(-50px);
            opacity: 0;
        }
    }

    .search-container {
        display: flex;
        align-items: center;
        flex-grow: 0.5;
        margin: 0 26px;
    }

    .search-bar {
        flex-grow: 1;
        padding: 10px 20px;
        border: none;
        border-radius: 26px;
        background-color: var(--secondary-color);
        color: var(--text-color);
        font-size: 16px;
        width: 50%;
    }

    .filter-btn {
        background-color: var(--primary-color);
        border: none;
        width: 36px;
        height: 36px;
        border-radius: 50%;
        margin-left: 13px;
        cursor: pointer;
        display: flex;
        justify-content: center;
        align-items: center;
        transition: background-color 0.3s ease;
    }

    .filter-btn:hover {
        background-color: #c73a50;
    }

    .filter-btn img {
        width: 22px;
        height: 22px;
    }

    .settings-btn {
        background-color: transparent;
        border: none;
        cursor: pointer;
        padding: 10px;
    }

    .settings-btn svg {
        width: 24px;
        height: 24px;
        fill: var(--primary-color);
    }

    .filter-section {
        display: none;
        position: fixed;
        top: 60px;
        left: 0;
        right: 0;
        background-color: rgba(10, 10, 10, 0.9);
        padding: 20px;
        z-index: 999;
        border-bottom: 1px solid var(--border-color);
    }

    .filter-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
        gap: 8px;
    }

    .filter-option {
        margin-bottom: 10px;
    }

    .filter-option label {
        display: block;
        margin-bottom: 5px;
        color: var(--primary-color);
        font-weight: bold;
    }

    .custom-select {
        position: relative;
        width: 100%;
        max-width: 100px;
    }

    .custom-select select {
        display: none;
    }

    .select-selected {
        background-color: var(--secondary-color);
        color: var(--text-color);
        padding: 8px 16px;
        border: 1px solid var(--primary-color);
        cursor: pointer;
        user-select: none;
        width: 100%;
        box-sizing: border-box;
    }

    .select-selected:after {
        position: absolute;
        content: "";
        top: 14px;
        right: 10px;
        width: 0;
        height: 0;
        border: 6px solid transparent;
        border-color: var(--primary-color) transparent transparent transparent;
    }

    .select-selected.select-arrow-active:after {
        border-color: transparent transparent var(--primary-color) transparent;
        top: 7px;
    }

    .select-items {
        position: absolute;
        background-color: var(--secondary-color);
        top: 100%;
        left: 0;
        right: 0;
        z-index: 99;
        max-height: 200px;
        overflow-y: auto;
    }

    .select-hide {
        display: none;
    }

    .select-items div {
        color: var(--text-color);
        padding: 8px 16px;
        border: 1px solid var(--primary-color);
        border-top: none;
        cursor: pointer;
        user-select: none;
    }

    .select-items div:hover, .same-as-selected {
        background-color: var(--primary-color);
    }

    .category-buttons {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: 20px;
    }

    .category-btn {
        background-color: var(--secondary-color);
        color: var(--text-color);
        border: 1px solid var(--primary-color);
        padding: 8px 16px;
        border-radius: 20px;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }

    .category-btn:hover,
    .category-btn.active {
        background-color: var(--primary-color);
    }

    .settings-modal {
        display: none;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: var(--secondary-color);
        padding: 26px;
        border-radius: 10px;
        z-index: 1001;
        border: 1px solid var(--border-color);
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .settings-option {
        display: flex;
        align-items: center;
        margin-bottom: 20px;
    }

    .settings-option label {
        margin-left: 15px;
        font-size: 16px;
    }

    .settings-title {
        font-size: 24px;
        font-weight: bold;
        color: var(--primary-color);
        margin-bottom: 20px;
    }

    .custom-checkbox {
        width: 20px;
        height: 20px;
        background-color: var(--secondary-color);
        border: 2px solid var(--primary-color);
        border-radius: 4px;
        display: inline-block;
        position: relative;
        cursor: pointer;
    }

    .custom-checkbox::after {
        content: '';
        position: absolute;
        display: none;
        left: 6px;
        top: 2px;
        width: 5px;
        height: 10px;
        border: solid var(--primary-color);
        border-width: 0 2px 2px 0;
        transform: rotate(45deg);
    }

    .settings-option input[type="checkbox"] {
        display: none;
    }

    .settings-option input[type="checkbox"]:checked + .custom-checkbox::after {
        display: block;
    }

    .container {
        height: 100%;
        overflow-y: scroll;
        scroll-snap-type: y mandatory;
        position: relative;
        scrollbar-width: none;
        -ms-overflow-style: none;
    }

    .container::-webkit-scrollbar {
        display: none;
    }

    .post-container {
        height: 100%;
        scroll-snap-align: start;
        position: relative;
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: var(--background-color);
        border: 1px solid var(--border-color);
    }

    .post-content {
        width: 100%;
        height: 100%;
        object-fit: contain;
    }

    .actions {
        position: absolute;
        right: 40px;
        bottom: 100px;
        display: flex;
        flex-direction: column;
        align-items: center;
        opacity: 1;
        transition: opacity 0.3s ease;
    }

    .actions.hidden {
        opacity: 0;
    }

    .action-btn {
        background: none;
        border: none;
        color: var(--text-color);
        font-size: 24px;
        margin: 10px 0;
        cursor: pointer;
        transition: color 0.3s ease;
    }

    .action-btn:hover {
        color: var(--primary-color);
    }

    .action-count {
        font-size: 14px;
        margin-top: 5px;
    }

    .user-info {
        position: absolute;
        left: 20px;
        bottom: 20px;
    }

    .username {
        font-weight: bold;
        font-size: 18px;
        margin-bottom: 5px;
    }

    .description {
        font-size: 14px;
        max-width: 250px;
        cursor: pointer;
    }

    .description.truncated::after {
        content: '...';
    }

    .subreddit-info {
        position: absolute;
        left: 20px;
        bottom: 60px;
        font-size: 16px;
        cursor: pointer;
        color: var(--primary-color);
    }

    .subreddit-info:hover {
        text-decoration: underline;
    }

    .overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 1000;
    }

    .loading-animation {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 50px;
        height: 50px;
        border: 3px solid var(--background-color);
        border-top: 3px solid var(--primary-color);
        border-radius: 50%;
        animation: spin 1s linear infinite;
    }

    @keyframes spin {
        0% { transform: translate(-50%, -50%) rotate(0deg); }
        100% { transform: translate(-50%, -50%) rotate(360deg); }
    }

    .search-icon {
        position: fixed;
        top: 20px;
        right: 20px;
        background-color: var(--primary-color);
        border: none;
        width: 36px;
        height: 36px;
        border-radius: 50%;
        cursor: pointer;
        display: flex;
        justify-content: center;
        align-items: center;
        transition: background-color 0.3s ease;
        z-index: 1000;
    }

    .search-icon:hover {
        background-color: #c73a50;
    }

    .search-icon img {
        width: 22px;
        height: 22px;
    }
</style>
</head>
<body>
    <div class="hub">
        <div class="hub-logo">
            Mokie
            <div class="nsfw-bubbles"></div>
        </div>
        <div class="search-container">
            <input type="text" class="search-bar" placeholder="Search subreddits...">
            <button class="filter-btn">
                <img src="https://cdn-icons-png.flaticon.com/256/6372/6372641.png" alt="Search Icon">
            </button>
        </div>
        <button class="settings-btn">
            <svg viewBox="0 0 24 24">
                <path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"></path>
            </svg>
        </button>
    </div>

    <button class="search-icon">
        <img src="https://cdn-icons-png.flaticon.com/256/6372/6372641.png" alt="Search Icon">
    </button>

    <div class="filter-section">
        <div class="filter-grid">
            <div class="filter-option">
                <label for="sortBy">Sort by:</label>
                <div class="custom-select">
                    <select id="sortBy">
                        <option value="hot">Hot</option>
                        <option value="new">New</option>
                        <option value="top">Top</option>
                        <option value="rising">Rising</option>
                    </select>
                </div>
            </div>
            <div class="filter-option">
                <label for="timeRange">Time range:</label>
                <div class="custom-select">
                    <select id="timeRange">
                        <option value="hour">Past hour</option>
                        <option value="day">Past 24 hours</option>
                        <option value="week">Past week</option>
                        <option value="month">Past month</option>
                        <option value="year">Past year</option>
                        <option value="all">All time</option>
                    </select>
                </div>
            </div>
            <div class="filter-option">
                <label for="contentType">Content type:</label>
                <div class="custom-select">
                    <select id="contentType">
                        <option value="all">All</option>
                        <option value="image">Images only</option>
                        <option value="video">Videos only</option>
                        <option value="album">Albums only</option>
                    </select>
                </div>
            </div>
        </div>
        <div class="filter-option">
            <label>NSFW Categories:</label>
            <div class="category-buttons">
                <button class="category-btn" data-category="all">All</button>
                <button class="category-btn" data-category="gonewild">gonewild</button>
                <button class="category-btn" data-category="nsfw">nsfw</button>
                <button class="category-btn" data-category="RealGirls">RealGirls</button>
                <button class="category-btn" data-category="NSFW_GIF">NSFW_GIF</button>
                <button class="category-btn" data-category="holdthemoan">holdthemoan</button>
                <button class="category-btn" data-category="LegalTeens">LegalTeens</button>
                <button class="category-btn" data-category="cumsluts">cumsluts</button>
                <button class="category-btn" data-category="AsiansGoneWild">AsiansGoneWild</button>
                <button class="category-btn" data-category="GoneWildCurvy">GoneWildCurvy</button>
                <button class="category-btn" data-category="amateur">amateur</button>
            </div>
        </div>
    </div>

    <div class="overlay"></div>

    <div class="settings-modal">
        <div class="settings-title">Settings</div>
        <div class="settings-option">
            <input type="checkbox" id="darkMode" checked>
            <label for="darkMode" class="custom-checkbox"></label>
            <label for="darkMode">Dark Mode</label>
        </div>
        <div class="settings-option">
            <input type="checkbox" id="autoplayVideos" checked>
            <label for="autoplayVideos" class="custom-checkbox"></label>
            <label for="autoplayVideos">Autoplay Videos</label>
        </div>
        <div class="settings-option">
            <input type="checkbox" id="showNSFW">
            <label for="showNSFW" class="custom-checkbox"></label>
            <label for="showNSFW">Show only NSFW Content</label>
        </div>
    </div>

    <div class="container">
        <!-- Content will be dynamically loaded here -->
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const container = document.querySelector('.container');
            const searchBar = document.querySelector('.search-bar');
            const filterBtn = document.querySelector('.filter-btn');
            const filterSection = document.querySelector('.filter-section');
            const settingsBtn = document.querySelector('.settings-btn');
            const settingsModal = document.querySelector('.settings-modal');
            const overlay = document.querySelector('.overlay');
            const darkModeToggle = document.getElementById('darkMode');
            const autoplayToggle = document.getElementById('autoplayVideos');
            const nsfwToggle = document.getElementById('showNSFW');
            const sortBySelect = document.getElementById('sortBy');
            const timeRangeSelect = document.getElementById('timeRange');
            const contentTypeSelect = document.getElementById('contentType');
            const categoryButtons = document.querySelectorAll('.category-btn');
            const hubLogo = document.querySelector('.hub-logo');
            const nsfwBubbles = document.querySelector('.nsfw-bubbles');
            const hub = document.querySelector('.hub');
            const searchIcon = document.querySelector('.search-icon');

            let isScrolling = false;
            let startY;
            let startTop;
            let selectedCategory = 'all';
            let currentSubreddit = '';
            let userPreferences = {
                likedPosts: [],
                searchHistory: [],
                viewedSubreddits: [],
                interactionHistory: []
            };

            let hubTimer;
            let isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);

            function hideHub() {
                hub.classList.add('hidden');
                searchIcon.style.display = 'flex';
            }

            function showHub() {
                hub.classList.remove('hidden');
                searchIcon.style.display = 'none';
            }

            if (isMobile) {
                document.addEventListener('touchstart', () => {
                    clearTimeout(hubTimer);
                    showHub();
                    hubTimer = setTimeout(hideHub, 2000);
                });
            } else {
                document.addEventListener('mousemove', (e) => {
                    clearTimeout(hubTimer);
                    if (e.clientY < 100) {
                        showHub();
                    } else {
                        hubTimer = setTimeout(hideHub, 2000);
                    }
                });
            }

            searchIcon.addEventListener('click', showHub);

            container.addEventListener('touchstart', (e) => {
                startY = e.touches[0].pageY;
                startTop = container.scrollTop;
                isScrolling = true;
            });

            container.addEventListener('touchmove', (e) => {
                if (!isScrolling) return;
                e.preventDefault();
                const y = e.touches[0].pageY;
                const walk = (y - startY) * 2;
                container.scrollTop = startTop - walk;
            });

            container.addEventListener('touchend', () => {
                isScrolling = false;
                const containerHeight = container.clientHeight;
                const scrollSnap = Math.round(container.scrollTop / containerHeight) * containerHeight;
                container.scrollTo({
                    top: scrollSnap,
                    behavior: 'smooth'
                });
            });

            filterBtn.addEventListener('click', () => {
                filterSection.style.display = filterSection.style.display === 'none' ? 'block' : 'none';
            });

            settingsBtn.addEventListener('click', () => {
                settingsModal.style.display = 'block';
                overlay.style.display = 'block';
            });

            overlay.addEventListener('click', () => {
                settingsModal.style.display = 'none';
                overlay.style.display = 'none';
            });

            darkModeToggle.addEventListener('change', toggleDarkMode);
            autoplayToggle.addEventListener('change', toggleAutoplay);
            nsfwToggle.addEventListener('change', toggleNSFW);

            searchBar.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    const searchTerm = this.value;
                    userPreferences.searchHistory.push(searchTerm);
                    searchReddit(searchTerm);
                }
            });

            sortBySelect.addEventListener('change', () => applyFilters());
            timeRangeSelect.addEventListener('change', () => applyFilters());
            contentTypeSelect.addEventListener('change', () => applyFilters());

            categoryButtons.forEach(button => {
                button.addEventListener('click', () => {
                    categoryButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    selectedCategory = button.dataset.category;
                    applyFilters();
                });
            });

            function applyFilters() {
                const query = searchBar.value;
                const sortBy = sortBySelect.value;
                const timeRange = timeRangeSelect.value;
                const contentType = contentTypeSelect.value;
                searchReddit(query, sortBy, timeRange, contentType, selectedCategory);
            }

            function searchReddit(query, sortBy = 'hot', timeRange = 'all', contentType = 'all', category = 'all') {
                const nsfwOnly = nsfwToggle.checked;
                let url;
                if (currentSubreddit) {
                    url = `https://www.reddit.com/r/${currentSubreddit}/${sortBy}.json?t=${timeRange}&limit=25`;
                } else {
                    url = `https://www.reddit.com/search.json?q=${query}+${category !== 'all' ? `subreddit:${category}` : ''}+nsfw:${nsfwOnly ? 'yes' : 'no'}&sort=${sortBy}&t=${timeRange}&include_over_18=${nsfwOnly}&limit=25`;
                }
                
                showLoadingAnimation();
                
                axios.get(url)
                    .then(response => {
                        const posts = response.data.data.children;
                        container.innerHTML = ''; // Clear existing content
                        posts.forEach(post => {
                            const postData = post.data;
                            if (contentType === 'all' || 
                                (contentType === 'image' && postData.post_hint === 'image') ||
                                (contentType === 'video' && postData.is_video) ||
                                (contentType === 'album' && postData.is_gallery)) {
                                const postElement = createPostElement(postData);
                                container.appendChild(postElement);
                            }
                        });
                        hideLoadingAnimation();
                    })
                    .catch(error => {
                        console.error('Error fetching data:', error);
                        hideLoadingAnimation();
                    });
            }

            function createPostElement(postData) {
                const postElement = document.createElement('div');
                postElement.className = 'post-container';
                
                let contentHtml;
                if (postData.is_video) {
                    contentHtml = `
                        <video class="post-content" ${autoplayToggle.checked ? 'autoplay' : ''} loop muted playsinline>
                            <source src="${postData.media.reddit_video.fallback_url}" type="video/mp4">
                        </video>
                    `;
                } else if (postData.post_hint === 'image') {
                    contentHtml = `<img class="post-content" src="${postData.url}" alt="${postData.title}" loading="lazy">`;
                } else if (postData.is_gallery) {
                    // Handle gallery posts
                    contentHtml = `<div class="post-content">Gallery post (${postData.gallery_data.items.length} images)</div>`;
                } else {
                    contentHtml = `<div class="post-content">${postData.selftext}</div>`;
                }

                const truncatedTitle = postData.title.length > 41 ? postData.title.slice(0, 41) + '...' : postData.title;

                postElement.innerHTML = `
                    ${contentHtml}
                    <div class="actions hidden">
                        <button class="action-btn like-btn" data-post-id="${postData.id}">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                            </svg>
                            <div class="action-count">${postData.ups}</div>
                        </button>
                        <button class="action-btn">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                            </svg>
                            <div class="action-count">${postData.num_comments}</div>
                        </button>
                        <button class="action-btn">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="18" cy="5" r="3"></circle>
                                <circle cx="6" cy="12" r="3"></circle>
                                <circle cx="18" cy="19" r="3"></circle>
                                <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
                                <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
                            </svg>
                            <div class="action-count">Share</div>
                        </button>
                    </div>
                    <div class="subreddit-info">${postData.subreddit_name_prefixed}</div>
                    <div class="user-info">
                        <div class="username">u/${postData.author}</div>
                        <div class="description${postData.title.length > 41 ? ' truncated' : ''}">${truncatedTitle}</div>
                    </div>
                `;

                const subredditInfo = postElement.querySelector('.subreddit-info');
                subredditInfo.addEventListener('click', () => {
                    currentSubreddit = postData.subreddit;
                    userPreferences.viewedSubreddits.push(currentSubreddit);
                    searchBar.value = currentSubreddit;
                    applyFilters();
                });

                const likeBtn = postElement.querySelector('.like-btn');
                likeBtn.addEventListener('click', () => {
                    const postId = likeBtn.dataset.postId;
                    if (!userPreferences.likedPosts.includes(postId)) {
                        userPreferences.likedPosts.push(postId);
                        likeBtn.classList.add('liked');
                    } else {
                        userPreferences.likedPosts = userPreferences.likedPosts.filter(id => id !== postId);
                        likeBtn.classList.remove('liked');
                    }
                    updateUserPreferences();
                });

                const description = postElement.querySelector('.description');
                description.addEventListener('click', () => {
                    if (postData.title.length > 41) {
                        description.textContent = description.textContent === truncatedTitle ? postData.title : truncatedTitle;
                        description.classList.toggle('truncated');
                    }
                });

                const actions = postElement.querySelector('.actions');
                let timeout;
                postElement.addEventListener('click', () => {
                    actions.classList.remove('hidden');
                    clearTimeout(timeout);
                    timeout = setTimeout(() => {
                        actions.classList.add('hidden');
                    }, 5000);
                });

                return postElement;
            }

            function toggleDarkMode() {
                document.body.classList.toggle('light-mode', !darkModeToggle.checked);
            }

            function toggleAutoplay() {
                const videos = document.querySelectorAll('video');
                videos.forEach(video => {
                    if (autoplayToggle.checked) {
                        video.setAttribute('autoplay', '');
                    } else {
                        video.removeAttribute('autoplay');
                    }
                });
            }

            function toggleNSFW() {
                applyFilters();
                if (nsfwToggle.checked) {
                    createBubbles();
                } else {
                    nsfwBubbles.innerHTML = '';
                }
            }

            function createBubbles() {
                nsfwBubbles.innerHTML = '';
                for (let i = 0; i < 20; i++) {
                    const bubble = document.createElement('div');
                    bubble.className = 'bubble';
                    bubble.style.left = `${Math.random() * 100}%`;
                    bubble.style.animationDelay = `${Math.random() * 2}s`;
                    bubble.style.width = `${Math.random() * 10 + 5}px`;
                    bubble.style.height = bubble.style.width;
                    nsfwBubbles.appendChild(bubble);
                }
            }

            function updateUserPreferences() {
                localStorage.setItem('userPreferences', JSON.stringify(userPreferences));
            }

            function loadUserPreferences() {
                const savedPreferences = localStorage.getItem('userPreferences');
                if (savedPreferences) {
                    userPreferences = JSON.parse(savedPreferences);
                }
            }

            function generateFYPFeed() {
                const likedSubreddits = userPreferences.likedPosts.map(postId => {
                    // Here you would normally fetch the subreddit for each liked post
                    // For this example, we'll just use a placeholder
                    return 'placeholder_subreddit';
                });

                const viewedSubreddits = userPreferences.viewedSubreddits;
                const searchTerms = userPreferences.searchHistory;

                // Combine and deduplicate the data
                const userInterests = [...new Set([...likedSubreddits, ...viewedSubreddits, ...searchTerms])];

                // Generate a query based on user interests
                const query = userInterests.join(' OR ');

                // Fetch posts based on user interests
                searchReddit(query, 'hot', 'all', 'all', 'all');
            }

            function showLoadingAnimation() {
                const loadingAnimation = document.createElement('div');
                loadingAnimation.className = 'loading-animation';
                container.appendChild(loadingAnimation);
            }

            function hideLoadingAnimation() {
                const loadingAnimation = container.querySelector('.loading-animation');
                if (loadingAnimation) {
                    loadingAnimation.remove();
                }
            }

            // Custom select implementation
            const customSelects = document.getElementsByClassName("custom-select");
            for (let i = 0; i < customSelects.length; i++) {
                const select = customSelects[i].getElementsByTagName("select")[0];
                const selectedDiv = document.createElement("DIV");
                selectedDiv.setAttribute("class", "select-selected");
                selectedDiv.innerHTML = select.options[select.selectedIndex].innerHTML;
                customSelects[i].appendChild(selectedDiv);

                const optionsDiv = document.createElement("DIV");
                optionsDiv.setAttribute("class", "select-items select-hide");
                for (let j = 0; j < select.length; j++) {
                    const optionDiv = document.createElement("DIV");
                    optionDiv.innerHTML = select.options[j].innerHTML;
                    optionDiv.addEventListener("click", function(e) {
                        const select = this.parentNode.parentNode.getElementsByTagName("select")[0];
                        const selected = this.parentNode.previousSibling;
                        for (let k = 0; k < select.length; k++) {
                            if (select.options[k].innerHTML == this.innerHTML) {
                                select.selectedIndex = k;
                                selected.innerHTML = this.innerHTML;
                                const sameAsSelected = this.parentNode.getElementsByClassName("same-as-selected");
                                for (let l = 0; l < sameAsSelected.length; l++) {
                                    sameAsSelected[l].removeAttribute("class");
                                }
                                this.setAttribute("class", "same-as-selected");
                                break;
                            }
                        }
                        selected.click();
                    });
                    optionsDiv.appendChild(optionDiv);
                }
                customSelects[i].appendChild(optionsDiv);

                selectedDiv.addEventListener("click", function(e) {
                    e.stopPropagation();
                    closeAllSelect(this);
                    this.nextSibling.classList.toggle("select-hide");
                    this.classList.toggle("select-arrow-active");
                });
            }

            function closeAllSelect(elmnt) {
                const arrNo = [];
                const selectItems = document.getElementsByClassName("select-items");
                const selectedItems = document.getElementsByClassName("select-selected");
                for (let i = 0; i < selectedItems.length; i++) {
                    if (elmnt == selectedItems[i]) {
                        arrNo.push(i);
                    } else {
                        selectedItems[i].classList.remove("select-arrow-active");
                    }
                }
                for (let i = 0; i < selectItems.length; i++) {
                    if (arrNo.indexOf(i) === -1) {
                        selectItems[i].classList.add("select-hide");
                    }
                }
            }

            document.addEventListener("click", closeAllSelect);

            // Initial load
            loadUserPreferences();
            generateFYPFeed();

            // Periodically update FYP feed
            setInterval(generateFYPFeed, 300000); // Update every 5 minutes
        });
    </script>
</body>
</html>